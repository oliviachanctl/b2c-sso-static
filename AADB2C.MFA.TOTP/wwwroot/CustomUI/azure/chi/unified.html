<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Lumen Portal : Sign In</title>

<!--#include file="ssi/azure_styles.html" -->

  <!--start page specific azure b2c styles-->
  <style>
      /* Following are generated styles via gulp. */
      /* inject: css */
      .unified_container .row .panel-default{padding:40px 30px;margin-top:auto;margin-bottom:auto;height:100%;background-color:#fff}.unified_container .row .panel-default .panel-body{max-width:380px;width:auto;margin:0 auto;padding:0}.unified_container .row .panel-default .panel-body .companyName{font-size:1.5em;margin-bottom:45px}.unified_container .row .panel-default .panel-body .companyLogo{display:block}.unified_container .row .panel-default .panel-body img{max-width:100%;width:auto;height:70px;margin:0 auto;display:block}.unified_container .row .panel-default .panel-body h3{font-size:1.5em;display:none}.unified_container .row .panel-default #api{display:table;margin:0;width:100%}.unified_container .row .panel-default #api .intro{display:block;text-align:left}.unified_container .row .panel-default #api .intro h2{font-size:20px}.unified_container .row .panel-default #api .divider{display:none}.unified_container .row .panel-default #api .localAccount{top:10px;width:100%}.unified_container .row .panel-default #api .localAccount .intro h2{font-size:20px}.unified_container .row .panel-default #api .localAccount .error{color:#b00;text-align:left}.unified_container .row .panel-default #api .localAccount .entry .buttons{margin:0 0 23px 0;text-align:left}.unified_container .row .panel-default #api .localAccount .entry .buttons button{background-image:none;background-color:#296ec6;border:none;border-radius:.5rem;cursor:pointer;display:inline-block;font-size:1em;font-weight:400;height:inherit;line-height:1.3333333;margin-top:2rem;margin-right:0;margin-bottom:1.2rem;margin-left:0;padding:10px 16px;text-align:center;touch-action:manipulation;user-select:none;vertical-align:middle;white-space:nowrap;width:inherit;-moz-user-select:none;-ms-touch-action:manipulation;-ms-user-select:none;-webkit-user-select:none;color:#fff;width:63%;box-shadow:0 0 30px 0 #dae1f7}@media screen and (-ms-high-contrast:active){.unified_container .row .panel-default #api .accountButton,.unified_container .row .panel-default #api .localAccount .entry .buttons button{border:1px dashed #fff}.unified_container .row .panel-default #api .accountButton:hover,.unified_container .row .panel-default #api .localAccount .entry .buttons button:hover{border:1px solid #fff}}.unified_container .row .panel-default #api .localAccount .entry .buttons button:focus,.unified_container .row .panel-default #api .localAccount .entry .buttons button:hover{-moz-box-shadow:none;-webkit-box-shadow:none;box-shadow:none;background-color:#1662c7;color:#fff}.unified_container .row .panel-default #api .localAccount .entry .entry-item{position:relative;width:100%;padding-top:6px;padding-bottom:6px;display:block}.unified_container .row .panel-default #api .localAccount .entry .entry-item label{display:none}.unified_container .row .panel-default #api .localAccount .entry .entry-item input:focus{border:2px solid #000}.unified_container .row .panel-default #api .localAccount .entry .entry-item input{outline:0;background-color:#fff!important;background-image:none!important;border-radius:.5rem!important;color:#555;display:inline-block;font-size:1em;height:50px;line-height:1.42857143;padding:6px 20px;transition:border-color ease-in-out .15s,box-shadow ease-in-out .15s!important;width:100%!important;-o-transition:border-color ease-in-out .15s,box-shadow ease-in-out .15s!important;-webkit-transition:border-color ease-in-out .15s,-webkit-box-shadow ease-in-out .15s!important}.unified_container .row .panel-default #api .localAccount .entry .entry-item #password{margin-bottom:20px}.unified_container .row .panel-default #api .localAccount .entry .entry-item .password-label{text-align:left;height:0;left:0;width:100%}.forgot-password{text-align:left}.forgot-password.center-height{position:absolute;bottom:0;clear:right;cursor:pointer;text-align:right}@keyframes slideInFromRight{0%{opacity:0;transform:translateX(50%)}100%{opacity:1;transform:translateX(0)}}.unified_container .row .panel-default #api .localAccount .entry .entry-item .password-label #forgotPassword{position:absolute;bottom:0;clear:right;cursor:pointer;text-align:right}.unified_container .row .panel-default #api .localAccount .rememberMe{margin-top:-2rem;text-align:right}.unified_container .row .panel-default #api .localAccount .rememberMe.align-to-left{margin-top:1rem;text-align:left}.working{display:none}.unified_container .row .panel-default #api .claims-provider-list-text-links p,.unified_container .row .panel-default #api .localAccount .create p{text-align:left;margin-top:-3rem;margin-bottom:3rem}.unified_container .row .panel-default #api .localAccount .create #createAccount{border-radius:.5rem;display:inline-block;font-size:1em;font-weight:400;height:inherit;line-height:1.3333333;padding:10px 16px;text-align:center;touch-action:manipulation;user-select:none;white-space:nowrap;-moz-user-select:none;-ms-touch-action:manipulation;-ms-user-select:none;-webkit-user-select:none;width:auto;margin-top:-3rem;cursor:pointer;animation:.5s ease-out 0s 1 slideInFromRight}.unified_container .row .panel-default #api .social{display:table-footer-group;position:relative;top:1px;width:auto}.unified_container .row .panel-default #api .accountButton{background-size:10% 70%;background-position-x:3%;background-position-y:50%;background-repeat:no-repeat;display:block;font-size:16px;height:45px;width:100%;margin-left:auto;overflow:hidden;padding:0 50px;max-width:380px;border:1px solid #605e5c;background-color:#fff;-moz-border-radius:.5rem;-webkit-border-radius:.5rem;border-radius:.5rem;margin-top:10px}.unified_container .row .panel-default #api .accountButton:hover{color:#fff;background-color:#1662c7}.claims-provider-list-text-links-bottom-under-form{text-align:left}@media (max-width:100%){.unified_container .row .panel-default{margin-top:auto;margin-bottom:auto;height:550px}.unified_container .row .panel-default .panel-body{padding:5rem 3rem;margin-top:20px}.unified_container .row .panel-default .panel-body .companyName{display:none}.unified_container .row .panel-default .panel-body .companyLogo{display:block}.unified_container .row .panel-default .panel-body h3{display:block}.unified_container .row .panel-default .panel-body #api{width:auto}.unified_container .row .panel-default .panel-body #api .social{top:370px;width:auto}.unified_container .row .panel-default .panel-body #api .social .options .accountButton{height:40px}.unified_container .row .panel-default .panel-body #api .social .options #FacebookExchange{background-size:12px;background-position:50% 75%;margin-bottom:10px}.unified_container .row .panel-default .panel-body #api .social .options #GoogleExchange{background-size:20px;background-position:50% 75%;margin-bottom:10px}.unified_container .row .panel-default .panel-body #api .social .options #TwitterExchange{background-size:20px;background-position-x:56px;background-position-y:14px;margin-bottom:10px}.unified_container .row .panel-default .panel-body #api .localAccount{top:20px}.unified_container .row .panel-default .panel-body #api .localAccount .entry .entry-item{display:block;width:100%;margin-bottom:10px}.unified_container .row .panel-default .panel-body #api .localAccount .entry .entry-item .password-label{top:145px}.unified_container .row .panel-default .panel-body #api .localAccount .entry .entry-item #logonIdentifier{height:40px}.unified_container .row .panel-default .panel-body #api .localAccount .entry .entry-item #password{height:40px}.unified_container .row .panel-default .panel-body #api .localAccount .entry .entry-item:nth-child(2){width:auto;float:left}.unified_container .row .panel-default .panel-body #api .localAccount .entry .buttons #next{width:auto;text-indent:-4px;height:40px;line-height:0;position:relative;bottom:5px;left:8px}}@media screen and (max-width:320px){.unified_container .row .panel-default #api .localAccount .rememberMe{margin:0;text-align:left}}
      /* endinject */
  </style>
  <!--end page specific azure b2c styles-->

<!--#include file="ssi/head_links.html" -->

</head>

<body>

<!-- azure b2c will not allow class="chi" to be on html or body elements -->
<div class="chi" id="articleWrapper">

  <article class="-bg--white">

<!--#include file="ssi/header.html" -->

  <main>

    <div class="-d--flex -px--4 -px-md--0 -justify-content--center">
      <div class="-pt--2 -w--100 -mw--480">
        <h2>Welcome to Lumen.</h2>
        <div class="chi-card -portal">
          <div class="chi-card__header -sm">
            <div class="chi-card__title">Sign In</div>
          </div>
          <div class="chi-card__content">
            <!-- azure b2c content in chi wrapper -->
            <div id="api"></div>

            <div class="chi-grid -pt--3 -text--center">
              <div class="chi-col"><a class="-text -mb--2 -mb-sm--0" href="https://controlcenter.lumen.com/business/prelogin/#/forgot-username-passwd">Forgot username/password</a></div>
            </div>
            <div class="-pt--3 -text--center">
              <a class="-text -mb--2 -mb-sm--0" href="https://www.lumen.com/help/en-us/control-center/general/troubleshooting-login-problems.html">Sign in help</a>
            </div>
          </div>
        </div>
      </div>
    </div>

  </main>

<!--#include file="ssi/footer.html" -->

  </article>

<!-- close extra articleWrapper -->
</div>

    <!-- add chi classes to azure b2c injected content -->
    <script type="text/javascript">
      $(function () {
          $('div.entry-item').addClass("chi-form__item -mt--2").first().addClass("-mt--4");
          $('label').addClass("chi-label");
          $('input').addClass("chi-input -lg");
          $('div.rememberMe').addClass("chi-checkbox");
          $('div.rememberMe').wrap( "<div class='chi-form__item -mt--2'></div>" );
          $('#rememberMe').addClass("chi-checkbox__input");
          $('div.rememberMe label').addClass("chi-checkbox__label");
          $('button#next').addClass("chi-button -primary -text--uppercase -justify-content--center -lg -mt--3 -w--100").css("height", "auto");
          $('div.error.itemLevel p').addClass("chi-label -status -danger -mt--0");


          //auto append required domain to username
          if ($('#signInName').length) {
              $('#signInName').blur(function () {
                  username = $('#signInName').val();
                  if (username && username.search('@') < 0) {
                      if (username.match(/^\d{10}$/)) {
                          $('#signInName').val(username + "tn@voip.control.centurylink.com");
                      } else {
                          $('#signInName').val(username + "@control.centurylink.com");
                      }
                      console.log("Automatically appended required domain to username: " + $('#signInName').val());
                      $('#signInName').after('<div id="appendInfo">Automatically appended required domain to username!</div>');
                      setTimeout(function() { $("#appendInfo").hide(2000) }, 2000);
                  }
              });
          }


          //react to error messages in the #api div
          //set up a Mutation Observer to watch for changes to the .error div in the #api div
          var observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                var mutationText = $(mutation.target).text();

                //replace error string with HTML
                if (mutationText.indexOf('[E10001]') >= 0) {
                    $(mutation.target).html("Your user name or password are incorrect.<br/>Please use the links below if you have forgotten your credentials or need further help.");
                }

                if (mutationText.indexOf('[E10003]') >= 0) {
                    $(mutation.target).html("Too many failed sign in attempts.<br/>For security purposes, signing in has been temporarily disabled.<br/><br/>Please use the links below if you have forgotten your credentials or need further help.");
                }

                //trigger notification via ajax, requires CORS configuration at url requested!
                if (mutationText.indexOf('[E10003]') >= 0) {
                    $.ajax({
                      type: "GET",
                      cache: false,
                      url: "https://controlcenter.lumen.com/janus/jweb/public/accountLocked",
                      data: "authenticatedUser=" + $('#signInName').val(),
                      beforeSend : function() {
                          //console.log("sending ajax request");
                      },
                      success: function(data) {
                          //console.log("ajax request successful");
                      },
                      error: function(data) {
                          //console.log("ajax request error: " + data.status);
                      }
                    });
                }
                //console.log("mutation observer says: " + $(mutation.target).text());

                //wrap p children in error div in chi alert structure...
                //DO NOT use a selector that selects content inside the mutator targetNode (infinite loop!)
                $('#api .error > p').wrap( "<div role='alert' class='chi-alert -danger -b--danger-light -bg--danger-lighter -mb--1'><div class='chi-alert__content'></div></div>" );
                $('.chi-alert__content:only-child').before( "<i class='chi-alert__icon chi-icon icon-circle-warning'/>" );
            });
          });
          var observerConfig = {
            attributes: true,
            childList: true,
            characterData: true,
            subtree: true
          };
          var targetNode = $('#api .error > p')[0];
          if (targetNode) observer.observe(targetNode, observerConfig);
        });

        // refresh page 5s before it expires
        // Azure B2C will reject POST after 3600s
        // mod_auth_openidc will reject POST based on the OIDCStateTimeout configuration (defaults to 300s)
        self.loginTimeout = setTimeout(function () {
          if (!document.getElementById('lpChat')) window.location.reload(true);
        }, 295*1000);

        //chi functions are potentially slow to load via Azure B2C
        self.chiTimer = setInterval(function() {
            var chiReady = false;
            try {
                chiReady = (typeof chi == "object") ? true : false;
            } catch (e) {}
            //console.log("chiReady is " + chiReady);
            if (chiReady) {
                clearInterval(self.chiTimer);
                //TODO: insert chi functions here as required (eg. chi.dropdown)
            }
        }, 100);
    </script>

    <!--
    <script>
        try {
          window.location.hash = window.btoa("https://www.lumen.com/login/::Return to Lumen portal");
        } catch(e) {
        }
    </script>
    -->

<!--#include file="ssi/foot_script.html" -->
</body>
</html>